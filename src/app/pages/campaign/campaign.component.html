<app-header [activeStep]="numericStep"></app-header>


<div class="campaign-wrapper">
  <div class="campaign-container">

    <!-- LEFT PANEL -->
    <section class="wizard-panel panel-left">
      <nav class="wizard-tabs">
        <span [class.active]="step === 'details'">Campaign Details</span>
        <span [class.active]="step === 'theme'">Select Theme</span>
      </nav>

      <div class="panel-content panel-scroll">
        <app-campaign-details
          [readonly]="step !== 'details'"
          [hidden]="step !== 'details'"
          (validityChange)="onDetailsValidity($event)">
        </app-campaign-details>

        <div class="vertical-select-fixed" [hidden]="step !== 'theme'">
          <app-select-theme
            [readonly]="step !== 'theme'"
            [verticals]="verticals"
            [templates]="templates"
            (verticalChange)="onVerticalSelected($event)"
            (templateChange)="onTemplateSelected($event)">
          </app-select-theme>
        </div>
      </div>
    </section>

    <!-- MIDDLE PANEL -->
    <section class="wizard-panel panel-middle">
      <nav class="wizard-tabs">
        <span [class.active]="step === 'assets'">Select Assets</span>
        <span [class.active]="step === 'automation'">Automation</span>
      </nav>

      <div class="panel-content panel-scroll">
        <app-select-assets
          [readonly]="step !== 'assets'"
          [hidden]="step !== 'assets'"
          [assets]="assets"
          [automatedIds]="automatedParentIds"
          [selectedAssetIds]="selectedAssetsIds"
          (selectionChange)="onAssetsSelected($event)"
          (editAsset)="onAssetSelected($event)"
          (automateChanged)="toggleAutomate($event)">
        </app-select-assets>

        <app-automation
          [readonly]="step !== 'automation'"
          [hidden]="step !== 'automation'"
          [automatedAssets]="automatedAssets"
          (increase)="increaseChildCount($event)"
          (decrease)="decreaseChildCount($event)"
          (update)="updateAutomation()">
        </app-automation>
      </div>
    </section>

    <!-- RIGHT PANEL -->
    <section class="wizard-panel panel-right">
      <nav class="wizard-tabs">
        <span [class.active]="step === 'asset-details'">Asset Details</span>
        <span [class.active]="step === 'data-source'">Data Source</span>
      </nav>

      <div class="panel-content panel-scroll">
        <app-asset-details
  *ngIf="selectedAssetForDetails"
  [asset]="selectedAssetForDetails"
  [figmaData]="figmaData"
  (validityChange)="onAssetDetailsValidity($event)">
</app-asset-details>



<!-- <app-data-source
  *ngIf="step === 'data-source' && selectedAssetForDetails"
  [asset]="selectedAssetForDetails!"
  [readonly]="step !== 'data-source'"
  (validityChange)="onDataSourceValidity($event)">
</app-data-source> -->

        <ng-container *ngIf="!selectedAssetForDetails">
          <div class="panel-help">
            <img src="assets/empty-illustration.svg" alt="" class="panel-img" />
            <div class="panel-msg-title">Nothing to Show</div>
            <div class="panel-msg-sub">Select an asset on the middle panel</div>
          </div>
        </ng-container>
      </div>
    </section>
  </div>

  <app-main-cta
    [backDisabled]="!canGoBack()"
    [nextDisabled]="!canGoNext()"
    (back)="onBack()"
    (next)="onNext()">
  </app-main-cta>
</div>
